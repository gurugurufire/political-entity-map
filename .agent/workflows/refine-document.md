---
description: 既存のドキュメントを読みやすく構造化し、図解（Mermaid）を追加して品質を高める手順
---

# /refine-document ワークフロー

既存のMarkdownドキュメントを分析し、「読みやすさ」「わかりやすさ」を劇的に向上させるためのリファクタリング手順です。
単なる整形だけでなく、情報の構造化と図解化（Mermaid）に重点を置きます。

## 📋 診断プロセス (Diagnosis)

まず、対象のファイルを `view_file` で読み込み、以下の観点で「処方箋」を決定します。

1.  **整形の必要性 (Need Clean?)**
    - 見出し階層が乱れているか？
    - 表が崩れているか？
    - → YESなら、`/clean-document` の手順を先に適用する。

2.  **構造化の必要性 (Need Structure?)**
    - 長文のテキストブロックが続いているか？
    - 箇条書きや表で表現できる情報が埋もれていないか？
    - 「Heart（意図）」と「Bone（事実）」が混在していないか？

3.  **図解の必要性 (Need Visualize?)**
    - 手順、プロセス、分岐条件がテキストだけで説明されているか？
    - 状態遷移（ステータス変化）に関する記述があるか？
    - → YESなら、Mermaidによる図解を計画する。

## 🛠 実行手順 (Refining Steps)

診断結果に基づき、必要なステップを選択的に実行します。

### ステップ 1: 洗練と構造化 (Refine & Structure)
冗長なテキストを研ぎ澄まし、構造化します。

- **要約と箇条書き**: 「〜です。〜ます。」という長文を、箇条書きのリストに変換する。
- **表組み**: パラメータ解説や対比情報は、Markdownテーブルに変換する。
- **配置**: ドキュメントの冒頭に `[TOC]` (目次) を配置する。

### ステップ 2: 図解化 (Visualize with Mermaid)
「百聞は一見に如かず」。テキストの説明を補完（または置換）する図を追加します。

- **フローチャート (`graph TD`)**: 業務フロー、処理手順、データの流れ。
- **状態遷移図 (`stateDiagram-v2`)**: ステータスの変化、ライフサイクル。
- **シーケンス図 (`sequenceDiagram`)**: 複数の登場人物（ユーザー、システム、他部署）間のやり取り。

### ステップ 3: 意図の明記 (Heart & Bone)
単なる仕様の羅列にならないよう、魂を吹き込みます。

- 各セクションの冒頭に、**「なぜこれが必要か」「どういう効果があるか」** という意図を短く記述する。
- 重要な注意点やTipsは `> 引用ブロック` を使って目立たせる。

## 💡 Claudeへの指示例

「`/refine-document` を実行して、この要件定義書をリファクタリングしてください。特に業務フローがわかりにくいので、Mermaid図を追加して、長文を箇条書きに整理してください。」
